import{M as D}from"./index.8bcd0233.js";import{b as E,a as v,_ as R,p as V}from"./main.9147d398.js";import{r as n,o as p,i as h,w as t,b as i,e as U,t as m,f as w,a as u,c as y}from"./vendor.b642d5e9.js";const S=E("user"),x=(e,o)=>v.get(`user/permission/${e}/${o}`),M=(e,o)=>v.put(`user/permission/${e}`,o),$=()=>v.post("user/checkin"),N=()=>v.post("user/checkout");var C={...S,getPermission:x,putPermission:M,userCheckin:$,userCheckout:N};const I={props:{show:{type:Boolean,default:!1},modelValue:{}},methods:{onCloseForm(){this.$emit("update:show",!1)},onUpdateData(){var e;C.putPermission((e=this.modelValue)==null?void 0:e.id,{permissions:this.permissions,roles:this.roles}).then(()=>{this.onCloseForm()})}},computed:{sourceRole(){return[{text:"All Role",sub:this.allroles.map(e=>({text:e.title,value:e.name}))}]},source(){return Object.keys(this.modules).map(e=>{let o=this.modules[e].map(a=>({text:a.title,value:a.name}));return{text:e,sub:o}})}},data(){return{modules:null,permissions:[],roles:[],allroles:[]}},mounted(){var e;C.getPermission((e=this.modelValue)==null?void 0:e.id,"web").then(({data:o})=>{let{modules:a,permissions:k,roles:l,allroles:r}=o.data;this.modules=a,this.permissions=k,this.roles=l,this.allroles=r})},setup(){}},B=u("h4",null,"Permission",-1);function F(e,o,a,k,l,r){const _=n("vh-group-checkbox"),d=n("vh-col"),g=n("vh-row"),f=n("vh-button"),P=n("vh-modal");return p(),h(P,{size:"lg",title:this.modelValue.name,show:a.show,onHide:r.onCloseForm},{footer:t(({})=>[i(f,{size:"sm",color:"warning",beforeIcon:"bi bi-x",onClick:r.onCloseForm},{default:t(()=>[U(m(e.$t("common.manager.button.cancel")),1)]),_:1},8,["onClick"]),i(f,{size:"sm",beforeIcon:"bi bi-pencil-square",onClick:o[2]||(o[2]=s=>r.onUpdateData())},{default:t(()=>[U(m(e.$t("common.manager.button.update")),1)]),_:1})]),default:t(()=>[i(g,null,{default:t(()=>[i(d,null,{default:t(()=>[i(_,{style:{"max-height":"500px"},modelValue:l.roles,"onUpdate:modelValue":o[0]||(o[0]=s=>l.roles=s),source:r.sourceRole,itemDisabled:(s,b)=>b!==void 0},null,8,["modelValue","source","itemDisabled"])]),_:1}),i(d,null,{default:t(()=>[B,l.modules?(p(),h(_,{key:0,style:{"max-height":"500px"},modelValue:l.permissions,"onUpdate:modelValue":o[1]||(o[1]=s=>l.permissions=s),source:r.source,itemDisabled:s=>this.modelValue.name==="supper-admin"},null,8,["modelValue","source","itemDisabled"])):w("",!0)]),_:1})]),_:1})]),_:1},8,["title","show","onHide"])}var j=R(I,[["render",F]]);const z={components:{Manager:D,Permission:j},methods:{SetPermission(e){this.DataRow=e,this.showModalPermission=!0}},data(){return{showModalPermission:!1,DataRow:{},option:{api:{...C},can:{new:V.USER.NEW,edit:V.USER.EDIT,remove:V.USER.REMOVE,permission:V.USER.PERMISSION},columns:[{title:"#",isSort:!1,isFilter:!1,dataCell:(e,o,a)=>o+a},{title:()=>this.$t("module.user.field.name"),field:"name"},{title:()=>this.$t("module.user.field.email"),field:"email"}]}}},setup(){}},A={class:"mb-3"},O={for:"idName",class:"form-label"},H={class:"mb-3"},T={for:"idEmail",class:"form-label"},q={key:0,class:"mb-3"},W={for:"idPassword",class:"form-label"};function G(e,o,a,k,l,r){const _=n("vh-button"),d=n("vh-input"),g=n("manager"),f=n("Permission"),P=n("vh-page");return p(),h(P,null,{default:t(()=>[u("h3",null,m(e.$t("module.user.title")),1),i(g,{option:l.option},{action_after:t(({row:s})=>[e.$can(l.option.can.permission)&&s.name!="supper-admin"?(p(),h(_,{key:0,beforeIcon:"bi bi-shield",color:"warning",size:"sm",onClick:b=>r.SetPermission(s)},{default:t(()=>[U(m(e.$t("module.user.button.permission")),1)]),_:2},1032,["onClick"])):w("",!0)]),form_update:t(({data:s,isNew:b})=>[u("div",A,[u("label",O,m(e.$t("module.user.field.name")),1),i(d,{id:"idName",modelValue:s.name,"onUpdate:modelValue":c=>s.name=c},null,8,["modelValue","onUpdate:modelValue"])]),u("div",H,[u("label",T,m(e.$t("module.user.field.email")),1),i(d,{id:"idEmail",modelValue:s.email,"onUpdate:modelValue":c=>s.email=c},null,8,["modelValue","onUpdate:modelValue"])]),b?(p(),y("div",q,[u("label",W,m(e.$t("module.user.field.password")),1),i(d,{id:"idPassword",type:"password",modelValue:s.password,"onUpdate:modelValue":c=>s.password=c},null,8,["modelValue","onUpdate:modelValue"])])):w("",!0)]),_:1},8,["option"]),l.showModalPermission?(p(),h(f,{key:0,show:l.showModalPermission,"onUpdate:show":o[0]||(o[0]=s=>l.showModalPermission=s),modelValue:l.DataRow,"onUpdate:modelValue":o[1]||(o[1]=s=>l.DataRow=s)},null,8,["show","modelValue"])):w("",!0)]),_:1})}var Q=R(z,[["render",G]]);export{Q as default};
