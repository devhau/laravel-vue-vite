import{r as d,o as k,c as A,b as m,w as a,g as _,t as v,u as w,a as C,e as y,s as N}from"./vendor.b9ae47ca.js";import{_ as J}from"./main.09aa98f8.js";const z={itemKey:"id",formsize:(e,t)=>"",checkButtonDelete:({row:e,index:t,start:c})=>!0,checkButtonUpdate:({row:e,index:t,start:c})=>!0,empty:"common.manager.table.empty",title:{new:"common.manager.title.new",edit:"common.manager.title.edit",confirmDelete:"common.manager.title.confirmDelete",remove:"common.manager.title.remove",action:"common.manager.title.action"},button:{new:"common.manager.button.new",edit:"common.manager.button.edit",remove:"common.manager.button.remove",delete:"common.manager.button.delete",cancel:"common.manager.button.cancel",active:"common.manager.button.active",view:"common.manager.button.view",detail:"common.manager.button.detail",update:"common.manager.button.update"},icon:{new:"bi bi-plus-square",edit:"bi bi-pencil-square",remove:"bi bi-trash",delete:"bi bi-trash",cancel:"bi bi-x",active:"bi bi-check-square",view:"bi bi-plus-square",detail:"bi bi-plus-square",update:"bi bi-pencil-square"}},P={props:{option:{},showAction:{default:!0},formsize:{defalut:"sm"}},computed:{page_start(){return this.current_page-3>0?this.current_page-3:1},page_end(){return this.current_page+3<this.last_page?this.current_page+3:this.last_page},optionConfigAction(){if(!this.showAction)return this.optionConfig;let{columns:e}=this.optionConfig,t=this.$t("common.manager.title.action");return e=[...e,{title:t,field:"button_action",isSort:!1,isFilter:!1}],{...this.optionConfig,columns:e}}},data(){return{optionConfig:{},showFormUpdate:!1,showFormConfirmRemove:!1,isNew:!1,dataUpdate:{},pages:[10,15,25,50,100],source:[],search:"",sort:{},filter:{},current_page:0,size_page:15,from_page:0,last_page:0,per_page:15,row_from:0,row_to:0,total:0}},methods:{onInputSearch(e){e.keyCode==13&&(this.search=e.target.value,this.onSearch())},onSort(e,t){this.sort[e.field]=t,this.$emit("sort",e,t),this.onSearch()},onFilter(e,t){this.filter[e.field]=t,this.$emit("filter",e,t),this.onSearch()},onSearch(){let{api:e}=this.optionConfig;e.getAll({sort:this.sort,filter:this.filter,search:this.search,page:this.current_page,per_page:this.size_page}).then(({data:t})=>{if(t&&t.OK){let{data:c,current_page:U,from:o,to:r,last_page:p,total:F}=t.data;this.source=c,this.current_page=U,this.row_from=o,this.row_to=r,this.last_page=p,this.total=F}})},onChangePage(e){this.current_page=e,this.onSearch()},onRemoveData(){let{api:e,validate:t,itemKey:c}=this.optionConfig;e.remove(this.dataUpdate[c]).then(()=>{this.onSearch(),this.onHideForm()})},onUpdateData(){let{api:e,validate:t,itemKey:c}=this.optionConfig;(!t||t({data:this.dataUpdate,isNew:this.isNew}))&&(this.isNew?e.add(this.dataUpdate).then(U=>{this.onSearch(),this.onHideForm()}):e.edit(this.dataUpdate[c],this.dataUpdate).then(U=>{this.onSearch(),this.onHideForm()}))},onShowConfirmRemove(e){this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormConfirmRemove=!0},onShowFormUpdate(e,t=!1){this.isNew=t,this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormUpdate=!0},onHideForm(){this.showFormUpdate=!1,this.showFormConfirmRemove=!1}},created(){this.optionConfig=Object.assign(z,this.option)},mounted(){this.optionConfig=Object.assign(z,this.option),this.onSearch()},watch:{option:{handler:function(e){this.optionConfig=Object.assign(z,e)},deep:!0,immediate:!0}},setup(){}},M={class:"vh-manager"},E={class:"vh-manager__header"},T={class:"vh-manager__header--left"},G={class:"vh-manager__header--center"},L={class:"vh-manager__header--right"},Q={class:"vh-manager__body"},W={class:"vh-manager__body--action"},X={class:"vh-manager__footer"};function Y(e,t,c,U,o,r){var D,B,R;const p=d("vh-button"),F=d("vh-modal"),O=d("vh-input"),V=d("vh-table"),q=d("vh-select"),I=d("vh-col"),K=d("vh-pagination"),j=d("vh-row");return k(),A("div",M,[m(F,{show:o.showFormConfirmRemove,title:e.$t("common.manager.title.remove"),onHide:t[2]||(t[2]=n=>o.showFormConfirmRemove=!1)},{footer:a(({})=>{var n,i,h,f,g,u;return[m(p,{size:"sm",color:"warning",beforeIcon:(h=(i=(n=o.optionConfig)==null?void 0:n.icon)==null?void 0:i.cancel)!=null?h:"",onClick:t[0]||(t[0]=s=>r.onHideForm())},{default:a(()=>{var s,l;return[_(v(e.$t((l=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:l.cancel)),1)]}),_:1},8,["beforeIcon"]),m(p,{size:"sm",color:"danger",beforeIcon:(u=(g=(f=o.optionConfig)==null?void 0:f.icon)==null?void 0:g.remove)!=null?u:"",onClick:t[1]||(t[1]=s=>r.onRemoveData())},{default:a(()=>{var s,l;return[_(v(e.$t((l=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:l.remove)),1)]}),_:1},8,["beforeIcon"])]}),default:a(()=>{var n,i;return[w(e.$slots,"content_confirmDelete",{data:o.dataUpdate,app:this}),_(" "+v(!e.$slots.content_confirmDelete&&e.$t((i=(n=o.optionConfig)==null?void 0:n.title)==null?void 0:i.confirmDelete))+" ",1)]}),_:3},8,["show","title"]),m(F,{size:o.optionConfig.formsize(o.isNew,o.dataUpdate),title:o.isNew?e.$t("common.manager.title.new"):e.$t("common.manager.title.edit"),show:o.showFormUpdate,onHide:t[5]||(t[5]=n=>o.showFormUpdate=!1)},{footer:a(({})=>{var n,i,h,f,g,u;return[m(p,{size:"sm",color:"warning",beforeIcon:(h=(i=(n=o.optionConfig)==null?void 0:n.icon)==null?void 0:i.cancel)!=null?h:"",onClick:t[3]||(t[3]=s=>r.onHideForm())},{default:a(()=>{var s,l;return[_(v(e.$t((l=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:l.cancel)),1)]}),_:1},8,["beforeIcon"]),m(p,{size:"sm",beforeIcon:(u=(g=(f=o.optionConfig)==null?void 0:f.icon)==null?void 0:g.update)!=null?u:"",onClick:t[4]||(t[4]=s=>r.onUpdateData())},{default:a(()=>{var s,l;return[_(v(e.$t((l=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:l.update)),1)]}),_:1},8,["beforeIcon"])]}),default:a(()=>[w(e.$slots,"form_update",{data:o.dataUpdate,app:this,isNew:o.isNew})]),_:3},8,["size","title","show"]),C("div",E,[C("div",T,[m(p,{size:"sm",beforeIcon:(R=(B=(D=o.optionConfig)==null?void 0:D.icon)==null?void 0:B.new)!=null?R:"",onClick:t[6]||(t[6]=n=>r.onShowFormUpdate({},!0))},{default:a(()=>{var n,i;return[_(v(e.$t((i=(n=o.optionConfig)==null?void 0:n.button)==null?void 0:i.new)),1)]}),_:1},8,["beforeIcon"]),w(e.$slots,"header_left",{app:this})]),C("div",G,[w(e.$slots,"header_center")]),C("div",L,[w(e.$slots,"header_right",{app:this}),m(O,{placeholder:"Search",style:{width:"150px"},onKeypress:r.onInputSearch,onBlur:t[7]||(t[7]=n=>n.target.value=this.search)},null,8,["onKeypress"])])]),C("div",Q,[m(V,{source:o.source,option:r.optionConfigAction,sort:o.sort,filter:o.filter,start:o.row_from,onSort:t[8]||(t[8]=(n,i)=>r.onSort(n,i)),onFilter:t[9]||(t[9]=(n,i)=>r.onFilter(n,i))},{field_button_action:a(({row:n,index:i,start:h})=>{var f,g,u,s,l,H;return[C("span",W,[w(e.$slots,"action_before",{row:n,app:this,index:i,start:h}),o.optionConfig.checkButtonDelete({row:n,index:i,start:h})?(k(),y(p,{key:0,size:"sm",color:"danger",onClick:b=>r.onShowConfirmRemove(n),beforeIcon:(u=(g=(f=o.optionConfig)==null?void 0:f.icon)==null?void 0:g.remove)!=null?u:""},{default:a(()=>{var b,S;return[_(v(e.$t((S=(b=o.optionConfig)==null?void 0:b.button)==null?void 0:S.remove)),1)]}),_:2},1032,["onClick","beforeIcon"])):N("",!0),o.optionConfig.checkButtonUpdate({row:n,index:i,start:h})?(k(),y(p,{key:1,size:"sm",beforeIcon:(H=(l=(s=o.optionConfig)==null?void 0:s.icon)==null?void 0:l.edit)!=null?H:"",onClick:b=>r.onShowFormUpdate(n)},{default:a(()=>{var b,S;return[_(v(e.$t((S=(b=o.optionConfig)==null?void 0:b.button)==null?void 0:S.edit)),1)]}),_:2},1032,["beforeIcon","onClick"])):N("",!0),w(e.$slots,"action_after",{row:n,app:this,index:i,start:h})])]}),_:3},8,["source","option","sort","filter","start"])]),C("div",X,[m(j,null,{default:a(()=>[m(I,{class:"col-none",style:{width:"105px",flex:"none"}},{default:a(()=>[m(q,{modelValue:o.size_page,"onUpdate:modelValue":t[10]||(t[10]=n=>o.size_page=n),class:"vh-inline-block",source:o.pages,onChange:t[11]||(t[11]=n=>r.onChangePage(1))},null,8,["modelValue","source"])]),_:1}),m(I,null,{default:a(()=>[this.last_page>0?(k(),y(K,{key:0,current:o.current_page,start:r.page_start,end:r.page_end,last:o.last_page,onPage:t[12]||(t[12]=n=>r.onChangePage(n)),next:">>",previous:"<<"},null,8,["current","start","end","last"])):N("",!0)]),_:1})]),_:1})])])}var $=J(P,[["render",Y]]);export{$ as M};
