import{o as u,c as y,a as g,F as q,u as A,s as U,g as _,t as d,r as v,i as G,b as c,w as l,e as z,v as F,j as D}from"./vendor.160d8dae.js";import{_ as E}from"./main.f9dab8c3.js";const Q={props:{errors:{}},setup(){}},W={key:0,class:"errors"};function X(e,o,a,h,t,i){return a.errors?(u(),y("div",W,[g("ul",null,[(u(!0),y(q,null,A(Object.keys(a.errors),b=>(u(),y("li",{key:b},[_(d(e.$t(b))+" : ",1),g("ul",null,[(u(!0),y(q,null,A(a.errors[b],p=>(u(),y("li",{key:p},d(e.$t(p)),1))),128))])]))),128))])])):U("",!0)}var Y=E(Q,[["render",X]]);const O={itemKey:"id",formsize:({isNew:e,data:o},a)=>a,checkButtonDelete:({row:e,index:o,start:a})=>!0,checkButtonUpdate:({row:e,index:o,start:a})=>!0,can:{index:"",new:"",edit:"",remove:""},empty:"common.manager.table.empty",title:{new:"common.manager.title.new",edit:"common.manager.title.edit",confirmDelete:"common.manager.title.confirmDelete",remove:"common.manager.title.remove",action:"common.manager.title.action"},button:{new:"common.manager.button.new",edit:"common.manager.button.edit",remove:"common.manager.button.remove",delete:"common.manager.button.delete",cancel:"common.manager.button.cancel",active:"common.manager.button.active",view:"common.manager.button.view",detail:"common.manager.button.detail",update:"common.manager.button.update"},icon:{new:"bi bi-plus-square",edit:"bi bi-pencil-square",remove:"bi bi-trash",delete:"bi bi-trash",cancel:"bi bi-x",active:"bi bi-check-square",view:"bi bi-plus-square",detail:"bi bi-plus-square",update:"bi bi-pencil-square"}},Z={components:{errors:Y},props:{option:{},showAction:{default:!0},showErrors:{default:!0},formsize:{defalut:"sm"}},computed:{page_start(){return this.current_page-3>0?this.current_page-3:1},page_end(){return this.current_page+3<this.last_page?this.current_page+3:this.last_page},optionConfigAction(){if(!this.showAction)return this.optionConfig;let{columns:e}=this.optionConfig,o=this.$t("common.manager.title.action");return e=[...e,{title:o,field:"button_action",isSort:!1,isFilter:!1}],{...this.optionConfig,columns:e}}},data(){return{optionConfig:{},showFormUpdate:!1,showFormConfirmRemove:!1,isNew:!1,dataUpdate:{},errors:void 0,pages:[10,15,25,50,100],source:[],search:"",sort:{},filter:{},current_page:0,size_page:15,from_page:0,last_page:0,per_page:15,row_from:0,row_to:0,total:0}},methods:{onInputSearch(e){e.keyCode==13&&(this.search=e.target.value,this.onSearch())},onSort(e,o){this.sort[e.field]=o,this.$emit("sort",e,o),this.onSearch()},onFilter(e,o){this.filter[e.field]=o,this.$emit("filter",e,o),this.onSearch()},onSearch(){let{api:e}=this.optionConfig;e.getAll({sort:this.sort,filter:this.filter,search:this.search,page:this.current_page,per_page:this.size_page}).then(({data:o})=>{if(o&&o.OK){let{data:a,current_page:h,from:t,to:i,last_page:b,total:p}=o.data;this.source=a,this.current_page=h,this.row_from=t,this.row_to=i,this.last_page=b,this.total=p}})},onChangePage(e){this.current_page=e,this.onSearch()},onRemoveData(){let{api:e,validate:o,itemKey:a}=this.optionConfig;this.errors=void 0,e.remove(this.dataUpdate[a]).then(h=>{h.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=h.data.errors})},onUpdateData(){let{api:e,validate:o,itemKey:a}=this.optionConfig;this.errors=void 0,(!o||o({data:this.dataUpdate,isNew:this.isNew}))&&(this.isNew?e.add(this.dataUpdate).then(h=>{console.log(h),h.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=h.data.errors}):e.edit(this.dataUpdate[a],this.dataUpdate).then(h=>{h.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=h.data.errors}))},onShowConfirmRemove(e){this.errors=void 0,this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormConfirmRemove=!0},onShowFormUpdate(e,o=!1){this.errors=void 0,this.isNew=o,this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormUpdate=!0},onHideForm(){this.errors=void 0,this.showFormUpdate=!1,this.showFormConfirmRemove=!1}},created(){this.optionConfig=Object.assign(O,this.option)},mounted(){this.optionConfig=Object.assign(O,this.option),this.onSearch()},watch:{option:{handler:function(e){this.optionConfig=Object.assign(O,e)},deep:!0,immediate:!0}},setup(){}},x={class:"vh-manager"},$={class:"vh-manager__header"},ee={class:"vh-manager__header--left"},oe={class:"vh-manager__header--center"},te={class:"vh-manager__header--right"},ne={class:"vh-manager__body"},re={class:"vh-manager__body--action"},ie={class:"vh-manager__footer"};function se(e,o,a,h,t,i){var R,H,j;const b=v("errors"),p=v("vh-button"),B=v("vh-modal"),J=v("vh-input"),P=v("vh-table"),M=v("vh-select"),K=v("vh-col"),L=v("vh-pagination"),T=v("vh-row"),I=G("can");return u(),y("div",x,[c(B,{show:t.showFormConfirmRemove,title:e.$t("common.manager.title.remove"),onHide:o[2]||(o[2]=n=>t.showFormConfirmRemove=!1)},{footer:l(({})=>{var n,r,f,w,C,S;return[c(p,{size:"sm",color:"warning",beforeIcon:(f=(r=(n=t.optionConfig)==null?void 0:n.icon)==null?void 0:r.cancel)!=null?f:"",onClick:o[0]||(o[0]=s=>i.onHideForm())},{default:l(()=>{var s,m;return[_(d(e.$t((m=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:m.cancel)),1)]}),_:1},8,["beforeIcon"]),c(p,{size:"sm",color:"danger",beforeIcon:(S=(C=(w=t.optionConfig)==null?void 0:w.icon)==null?void 0:C.remove)!=null?S:"",onClick:o[1]||(o[1]=s=>i.onRemoveData())},{default:l(()=>{var s,m;return[_(d(e.$t((m=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:m.remove)),1)]}),_:1},8,["beforeIcon"])]}),default:l(()=>{var n,r;return[a.showErrors?(u(),z(b,{key:0,errors:t.errors},null,8,["errors"])):U("",!0),F(e.$slots,"content_confirmDelete",{data:t.dataUpdate,errors:t.errors,app:this}),_(" "+d(!e.$slots.content_confirmDelete&&e.$t((r=(n=t.optionConfig)==null?void 0:n.title)==null?void 0:r.confirmDelete))+" ",1)]}),_:3},8,["show","title"]),c(B,{size:t.optionConfig.formsize({isNew:t.isNew,data:t.dataUpdate},this.formsize),title:t.isNew?e.$t("common.manager.title.new"):e.$t("common.manager.title.edit"),show:t.showFormUpdate,onHide:o[5]||(o[5]=n=>t.showFormUpdate=!1)},{footer:l(({})=>{var n,r,f,w,C,S;return[c(p,{size:"sm",color:"warning",beforeIcon:(f=(r=(n=t.optionConfig)==null?void 0:n.icon)==null?void 0:r.cancel)!=null?f:"",onClick:o[3]||(o[3]=s=>i.onHideForm())},{default:l(()=>{var s,m;return[_(d(e.$t((m=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:m.cancel)),1)]}),_:1},8,["beforeIcon"]),c(p,{size:"sm",beforeIcon:(S=(C=(w=t.optionConfig)==null?void 0:w.icon)==null?void 0:C.update)!=null?S:"",onClick:o[4]||(o[4]=s=>i.onUpdateData())},{default:l(()=>{var s,m;return[_(d(e.$t((m=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:m.update)),1)]}),_:1},8,["beforeIcon"])]}),default:l(()=>[a.showErrors?(u(),z(b,{key:0,errors:t.errors},null,8,["errors"])):U("",!0),F(e.$slots,"form_update",{data:t.dataUpdate,app:this,errors:t.errors,isNew:t.isNew})]),_:3},8,["size","title","show"]),g("div",$,[g("div",ee,[D(c(p,{size:"sm",beforeIcon:(j=(H=(R=t.optionConfig)==null?void 0:R.icon)==null?void 0:H.new)!=null?j:"",onClick:o[6]||(o[6]=n=>i.onShowFormUpdate({},!0))},{default:l(()=>{var n,r;return[_(d(e.$t((r=(n=t.optionConfig)==null?void 0:n.button)==null?void 0:r.new)),1)]}),_:1},8,["beforeIcon"]),[[I,t.optionConfig.can.new]]),F(e.$slots,"header_left",{app:this})]),g("div",oe,[F(e.$slots,"header_center")]),g("div",te,[F(e.$slots,"header_right",{app:this}),c(J,{placeholder:"Search",style:{width:"150px"},onKeypress:i.onInputSearch,onBlur:o[7]||(o[7]=n=>n.target.value=this.search)},null,8,["onKeypress"])])]),g("div",ne,[c(P,{source:t.source,option:i.optionConfigAction,sort:t.sort,filter:t.filter,start:t.row_from,onSort:o[8]||(o[8]=(n,r)=>i.onSort(n,r)),onFilter:o[9]||(o[9]=(n,r)=>i.onFilter(n,r))},{field_button_action:l(({row:n,index:r,start:f})=>{var w,C,S,s,m,V;return[g("span",re,[F(e.$slots,"action_before",{row:n,app:this,index:r,start:f}),t.optionConfig.checkButtonDelete({row:n,index:r,start:f})?D((u(),z(p,{key:0,size:"sm",color:"danger",onClick:k=>i.onShowConfirmRemove(n),beforeIcon:(S=(C=(w=t.optionConfig)==null?void 0:w.icon)==null?void 0:C.remove)!=null?S:""},{default:l(()=>{var k,N;return[_(d(e.$t((N=(k=t.optionConfig)==null?void 0:k.button)==null?void 0:N.remove)),1)]}),_:2},1032,["onClick","beforeIcon"])),[[I,t.optionConfig.can.remove]]):U("",!0),t.optionConfig.checkButtonUpdate({row:n,index:r,start:f})?D((u(),z(p,{key:1,size:"sm",beforeIcon:(V=(m=(s=t.optionConfig)==null?void 0:s.icon)==null?void 0:m.edit)!=null?V:"",onClick:k=>i.onShowFormUpdate(n)},{default:l(()=>{var k,N;return[_(d(e.$t((N=(k=t.optionConfig)==null?void 0:k.button)==null?void 0:N.edit)),1)]}),_:2},1032,["beforeIcon","onClick"])),[[I,t.optionConfig.can.edit]]):U("",!0),F(e.$slots,"action_after",{row:n,app:this,index:r,start:f})])]}),_:3},8,["source","option","sort","filter","start"])]),g("div",ie,[c(T,null,{default:l(()=>[c(K,{class:"col-none",style:{width:"105px",flex:"none"}},{default:l(()=>[c(M,{modelValue:t.size_page,"onUpdate:modelValue":o[10]||(o[10]=n=>t.size_page=n),class:"vh-inline-block",source:t.pages,onChange:o[11]||(o[11]=n=>i.onChangePage(1))},null,8,["modelValue","source"])]),_:1}),c(K,null,{default:l(()=>[this.last_page>0?(u(),z(L,{key:0,current:t.current_page,start:i.page_start,end:i.page_end,last:t.last_page,onPage:o[12]||(o[12]=n=>i.onChangePage(n)),next:">>",previous:"<<"},null,8,["current","start","end","last"])):U("",!0)]),_:1})]),_:1})])])}var me=E(Z,[["render",se]]);export{me as M};
