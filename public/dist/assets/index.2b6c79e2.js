import{_ as P,e as j}from"./main.357a1ee0.js";import{r as u,v as M,o as k,c as T,b as m,w as a,e as _,t as C,i as F,f as U,k as w,a as S,x as I}from"./vendor.d37cc74f.js";const G={itemKey:"id",formsize:({isNew:e,data:o},h)=>h,checkButtonDelete:({row:e,index:o,start:h})=>!0,checkButtonUpdate:({row:e,index:o,start:h})=>!0,query:{new:({option:e,app:o})=>({}),sort:({option:e,app:o})=>({}),filter:({option:e,app:o})=>({})},can:{index:"",new:"",edit:"",remove:""},empty:"common.manager.table.empty",title:{new:"common.manager.title.new",edit:"common.manager.title.edit",confirmDelete:"common.manager.title.confirmDelete",remove:"common.manager.title.remove",action:"common.manager.title.action"},button:{new:"common.manager.button.new",edit:"common.manager.button.edit",remove:"common.manager.button.remove",delete:"common.manager.button.delete",cancel:"common.manager.button.cancel",active:"common.manager.button.active",view:"common.manager.button.view",detail:"common.manager.button.detail",update:"common.manager.button.update"},icon:{new:"bi bi-plus-square",edit:"bi bi-pencil-square",remove:"bi bi-trash",delete:"bi bi-trash",cancel:"bi bi-x",active:"bi bi-check-square",view:"bi bi-plus-square",detail:"bi bi-plus-square",update:"bi bi-pencil-square"}},L={components:{errors:j},props:{option:{},showAction:{default:!0},showErrors:{default:!0},formsize:{defalut:"sm"}},computed:{page_start(){return this.current_page-3>0?this.current_page-3:1},page_end(){return this.current_page+3<this.last_page?this.current_page+3:this.last_page},optionConfigAction(){if(!this.showAction)return this.optionConfig;let{columns:e}=this.optionConfig,o=this.$t("common.manager.title.action");return e=[...e,{title:o,field:"button_action",isSort:!1,isFilter:!1}],{...this.optionConfig,columns:e}}},data(){return{optionConfig:{},showFormUpdate:!1,showFormConfirmRemove:!1,isNew:!1,dataUpdate:{},errors:void 0,pages:[10,15,25,50,100],source:[],search:"",sort:{},filter:{},current_page:0,size_page:15,from_page:0,last_page:0,per_page:15,row_from:0,row_to:0,total:0}},methods:{onInputSearch(e){e.keyCode==13&&(this.search=e.target.value,this.onSearch())},onSort(e,o){this.sort={},this.sort[e.field]=o,this.$emit("sort",e,o),this.onSearch()},onFilter(e,o){this.filter[e.field]=o,this.$emit("filter",e,o),this.onSearch()},onSearch(){let{api:e}=this.optionConfig;e.getAll({sort:this.sort,filter:this.filter,search:this.search,page:this.current_page,per_page:this.size_page}).then(({data:o})=>{if(o&&o.OK){let{data:h,current_page:p,from:t,to:r,last_page:N,total:c}=o.data;this.source=h,this.current_page=p,this.row_from=t,this.row_to=r,this.last_page=N,this.total=c}})},onChangePage(e){this.current_page=e,this.onSearch()},onRemoveData(){let{api:e,validate:o,itemKey:h}=this.optionConfig;this.errors=void 0,e.remove(this.dataUpdate[h]).then(p=>{p.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=p.data.errors})},onUpdateData(){let{api:e,validate:o,itemKey:h}=this.optionConfig;this.errors=void 0,(!o||o({data:this.dataUpdate,isNew:this.isNew}))&&(this.isNew?e.add(this.dataUpdate).then(p=>{p.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=p.data.errors}):e.edit(this.dataUpdate[h],this.dataUpdate).then(p=>{p.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=p.data.errors}))},onShowConfirmRemove(e){this.errors=void 0,this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormConfirmRemove=!0},onShowFormUpdate(e,o=!1){this.errors=void 0,this.isNew=o,this.dataUpdate=JSON.parse(JSON.stringify(e!=null?e:{})),this.showFormUpdate=!0},onHideForm(){this.errors=void 0,this.showFormUpdate=!1,this.showFormConfirmRemove=!1},setOptionConfig(e){this.optionConfig=Object.assign(G,e)},clearFilter(){var e,o;this.optionConfig.query.sort&&(this.sort=(e=this.optionConfig.query.sort({option:this.optionConfig,app:this}))!=null?e:{}),this.optionConfig.query.filter&&(this.filter=(o=this.optionConfig.query.filter({option:this.optionConfig,app:this}))!=null?o:{}),this.onSearch()}},created(){this.setOptionConfig(this.option)},mounted(){this.setOptionConfig(this.option),this.clearFilter()},watch:{option:{handler:function(e){this.setOptionConfig(e)},deep:!0,immediate:!0}},setup(){}},Q={class:"vh-manager"},W={class:"vh-manager__header"},X={class:"vh-manager__header--left"},Y={class:"vh-manager__header--center"},Z={class:"vh-manager__header--right"},x={class:"vh-manager__body"},$={class:"vh-manager__body--action"},ee={class:"vh-manager__footer"};function oe(e,o,h,p,t,r){var q,H,B;const N=u("errors"),c=u("vh-button"),D=u("vh-modal"),R=u("vh-input"),V=u("vh-table"),A=u("vh-select"),O=u("vh-col"),E=u("vh-pagination"),J=u("vh-row"),z=M("can");return k(),T("div",Q,[m(D,{show:t.showFormConfirmRemove,title:e.$t("common.manager.title.remove"),onHide:o[2]||(o[2]=n=>r.onHideForm())},{footer:a(({})=>{var n,i,f,d,g,v;return[m(c,{size:"sm",color:"warning",beforeIcon:(f=(i=(n=t.optionConfig)==null?void 0:n.icon)==null?void 0:i.cancel)!=null?f:"",onClick:o[0]||(o[0]=s=>r.onHideForm())},{default:a(()=>{var s,l;return[_(C(e.$t((l=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:l.cancel)),1)]}),_:1},8,["beforeIcon"]),m(c,{size:"sm",color:"danger",beforeIcon:(v=(g=(d=t.optionConfig)==null?void 0:d.icon)==null?void 0:g.remove)!=null?v:"",onClick:o[1]||(o[1]=s=>r.onRemoveData())},{default:a(()=>{var s,l;return[_(C(e.$t((l=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:l.remove)),1)]}),_:1},8,["beforeIcon"])]}),default:a(()=>{var n,i;return[h.showErrors?(k(),F(N,{key:0,errors:t.errors},null,8,["errors"])):U("",!0),w(e.$slots,"content_confirmDelete",{data:t.dataUpdate,errors:t.errors,app:this}),_(" "+C(!e.$slots.content_confirmDelete&&e.$t((i=(n=t.optionConfig)==null?void 0:n.title)==null?void 0:i.confirmDelete))+" ",1)]}),_:3},8,["show","title"]),m(D,{size:t.optionConfig.formsize({isNew:t.isNew,data:t.dataUpdate},this.formsize),title:t.isNew?e.$t("common.manager.title.new"):e.$t("common.manager.title.edit"),show:t.showFormUpdate,onHide:o[5]||(o[5]=n=>r.onHideForm())},{footer:a(({})=>{var n,i,f,d,g,v;return[m(c,{size:"sm",color:"warning",beforeIcon:(f=(i=(n=t.optionConfig)==null?void 0:n.icon)==null?void 0:i.cancel)!=null?f:"",onClick:o[3]||(o[3]=s=>r.onHideForm())},{default:a(()=>{var s,l;return[_(C(e.$t((l=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:l.cancel)),1)]}),_:1},8,["beforeIcon"]),m(c,{size:"sm",beforeIcon:(v=(g=(d=t.optionConfig)==null?void 0:d.icon)==null?void 0:g.update)!=null?v:"",onClick:o[4]||(o[4]=s=>r.onUpdateData())},{default:a(()=>{var s,l;return[_(C(e.$t((l=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:l.update)),1)]}),_:1},8,["beforeIcon"])]}),default:a(()=>[h.showErrors?(k(),F(N,{key:0,errors:t.errors},null,8,["errors"])):U("",!0),w(e.$slots,"form_update",{data:t.dataUpdate,app:this,errors:t.errors,isNew:t.isNew})]),_:3},8,["size","title","show"]),S("div",W,[S("div",X,[I(m(c,{size:"sm",beforeIcon:(B=(H=(q=t.optionConfig)==null?void 0:q.icon)==null?void 0:H.new)!=null?B:"",onClick:o[6]||(o[6]=n=>r.onShowFormUpdate({},!0))},{default:a(()=>{var n,i;return[_(C(e.$t((i=(n=t.optionConfig)==null?void 0:n.button)==null?void 0:i.new)),1)]}),_:1},8,["beforeIcon"]),[[z,t.optionConfig.can.new]]),w(e.$slots,"header_left",{app:this})]),S("div",Y,[w(e.$slots,"header_center")]),S("div",Z,[w(e.$slots,"header_right",{app:this}),m(R,{placeholder:"Search",style:{width:"150px"},onKeypress:r.onInputSearch,onBlur:o[7]||(o[7]=n=>n.target.value=this.search)},null,8,["onKeypress"])])]),S("div",x,[m(V,{source:t.source,option:r.optionConfigAction,sort:t.sort,filter:t.filter,start:t.row_from,onSort:o[8]||(o[8]=(n,i)=>r.onSort(n,i)),onFilter:o[9]||(o[9]=(n,i)=>r.onFilter(n,i))},{field_button_action:a(({row:n,index:i,start:f})=>{var d,g,v,s,l,K;return[S("span",$,[w(e.$slots,"action_before",{row:n,app:this,index:i,start:f}),t.optionConfig.checkButtonDelete({row:n,index:i,start:f})?I((k(),F(c,{key:0,size:"sm",color:"danger",onClick:b=>r.onShowConfirmRemove(n),beforeIcon:(v=(g=(d=t.optionConfig)==null?void 0:d.icon)==null?void 0:g.remove)!=null?v:""},{default:a(()=>{var b,y;return[_(C(e.$t((y=(b=t.optionConfig)==null?void 0:b.button)==null?void 0:y.remove)),1)]}),_:2},1032,["onClick","beforeIcon"])),[[z,t.optionConfig.can.remove]]):U("",!0),t.optionConfig.checkButtonUpdate({row:n,index:i,start:f})?I((k(),F(c,{key:1,size:"sm",beforeIcon:(K=(l=(s=t.optionConfig)==null?void 0:s.icon)==null?void 0:l.edit)!=null?K:"",onClick:b=>r.onShowFormUpdate(n)},{default:a(()=>{var b,y;return[_(C(e.$t((y=(b=t.optionConfig)==null?void 0:b.button)==null?void 0:y.edit)),1)]}),_:2},1032,["beforeIcon","onClick"])),[[z,t.optionConfig.can.edit]]):U("",!0),w(e.$slots,"action_after",{row:n,app:this,index:i,start:f})])]}),_:3},8,["source","option","sort","filter","start"])]),S("div",ee,[m(J,null,{default:a(()=>[m(O,{class:"col-none",style:{width:"105px",flex:"none"}},{default:a(()=>[m(A,{modelValue:t.size_page,"onUpdate:modelValue":o[10]||(o[10]=n=>t.size_page=n),class:"vh-inline-block",source:t.pages,onChange:o[11]||(o[11]=n=>r.onChangePage(1))},null,8,["modelValue","source"])]),_:1}),m(O,null,{default:a(()=>[this.last_page>0?(k(),F(E,{key:0,current:t.current_page,start:r.page_start,end:r.page_end,last:t.last_page,onPage:o[12]||(o[12]=n=>r.onChangePage(n)),next:">>",previous:"<<"},null,8,["current","start","end","last"])):U("",!0)]),_:1})]),_:1})])])}var ie=P(L,[["render",oe]]);export{ie as M};
