import{o as f,c as k,a as g,F as V,u as j,s as U,g as _,t as d,r as v,i as T,b as m,w as l,e as z,v as S,j as D}from"./vendor.0fa58858.js";import{_ as A}from"./main.4070e8ce.js";const G={props:{errors:{}},setup(){}},Q={key:0,class:"errors"};function W(e,o,a,p,t,i){return a.errors?(f(),k("div",Q,[g("ul",null,[(f(!0),k(V,null,j(Object.keys(a.errors),C=>(f(),k("li",{key:C},[_(d(e.$t(C))+" : ",1),g("ul",null,[(f(!0),k(V,null,j(a.errors[C],c=>(f(),k("li",{key:c},d(e.$t(c)),1))),128))])]))),128))])])):U("",!0)}var X=A(G,[["render",W]]);const Y={itemKey:"id",formsize:({isNew:e,data:o},a)=>a,checkButtonDelete:({row:e,index:o,start:a})=>!0,checkButtonUpdate:({row:e,index:o,start:a})=>!0,query:{new:({option:e,app:o})=>({}),sort:({option:e,app:o})=>({}),filter:({option:e,app:o})=>({})},can:{index:"",new:"",edit:"",remove:""},empty:"common.manager.table.empty",title:{new:"common.manager.title.new",edit:"common.manager.title.edit",confirmDelete:"common.manager.title.confirmDelete",remove:"common.manager.title.remove",action:"common.manager.title.action"},button:{new:"common.manager.button.new",edit:"common.manager.button.edit",remove:"common.manager.button.remove",delete:"common.manager.button.delete",cancel:"common.manager.button.cancel",active:"common.manager.button.active",view:"common.manager.button.view",detail:"common.manager.button.detail",update:"common.manager.button.update"},icon:{new:"bi bi-plus-square",edit:"bi bi-pencil-square",remove:"bi bi-trash",delete:"bi bi-trash",cancel:"bi bi-x",active:"bi bi-check-square",view:"bi bi-plus-square",detail:"bi bi-plus-square",update:"bi bi-pencil-square"}},Z={components:{errors:X},props:{option:{},showAction:{default:!0},showErrors:{default:!0},formsize:{defalut:"sm"}},computed:{page_start(){return this.current_page-3>0?this.current_page-3:1},page_end(){return this.current_page+3<this.last_page?this.current_page+3:this.last_page},optionConfigAction(){if(!this.showAction)return this.optionConfig;let{columns:e}=this.optionConfig,o=this.$t("common.manager.title.action");return e=[...e,{title:o,field:"button_action",isSort:!1,isFilter:!1}],{...this.optionConfig,columns:e}}},data(){return{optionConfig:{},showFormUpdate:!1,showFormConfirmRemove:!1,isNew:!1,dataUpdate:{},errors:void 0,pages:[10,15,25,50,100],source:[],search:"",sort:{},filter:{},current_page:0,size_page:15,from_page:0,last_page:0,per_page:15,row_from:0,row_to:0,total:0}},methods:{onInputSearch(e){e.keyCode==13&&(this.search=e.target.value,this.onSearch())},onSort(e,o){this.sort={},this.sort[e.field]=o,this.$emit("sort",e,o),this.onSearch()},onFilter(e,o){this.filter[e.field]=o,this.$emit("filter",e,o),this.onSearch()},onSearch(){let{api:e}=this.optionConfig;e.getAll({sort:this.sort,filter:this.filter,search:this.search,page:this.current_page,per_page:this.size_page}).then(({data:o})=>{if(o&&o.OK){let{data:a,current_page:p,from:t,to:i,last_page:C,total:c}=o.data;this.source=a,this.current_page=p,this.row_from=t,this.row_to=i,this.last_page=C,this.total=c}})},onChangePage(e){this.current_page=e,this.onSearch()},onRemoveData(){let{api:e,validate:o,itemKey:a}=this.optionConfig;this.errors=void 0,e.remove(this.dataUpdate[a]).then(p=>{p.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=p.data.errors})},onUpdateData(){let{api:e,validate:o,itemKey:a}=this.optionConfig;this.errors=void 0,(!o||o({data:this.dataUpdate,isNew:this.isNew}))&&(this.isNew?e.add(this.dataUpdate).then(p=>{p.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=p.data.errors}):e.edit(this.dataUpdate[a],this.dataUpdate).then(p=>{p.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=p.data.errors}))},onShowConfirmRemove(e){this.errors=void 0,this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormConfirmRemove=!0},onShowFormUpdate(e,o=!1){this.errors=void 0,this.isNew=o,this.dataUpdate=JSON.parse(JSON.stringify(e!=null?e:{})),this.showFormUpdate=!0},onHideForm(){this.errors=void 0,this.showFormUpdate=!1,this.showFormConfirmRemove=!1},setOptionConfig(e){this.optionConfig=Object.assign(Y,e)},clearFilter(){var e,o;this.optionConfig.query.sort&&(this.sort=(e=this.optionConfig.query.sort({option:this.optionConfig,app:this}))!=null?e:{}),this.optionConfig.query.filter&&(this.filter=(o=this.optionConfig.query.filter({option:this.optionConfig,app:this}))!=null?o:{}),this.onSearch()}},created(){this.setOptionConfig(this.option)},mounted(){this.setOptionConfig(this.option),this.clearFilter()},watch:{option:{handler:function(e){this.setOptionConfig(e)},deep:!0,immediate:!0}},setup(){}},x={class:"vh-manager"},$={class:"vh-manager__header"},ee={class:"vh-manager__header--left"},oe={class:"vh-manager__header--center"},te={class:"vh-manager__header--right"},ne={class:"vh-manager__body"},ie={class:"vh-manager__body--action"},re={class:"vh-manager__footer"};function se(e,o,a,p,t,i){var H,B,K;const C=v("errors"),c=v("vh-button"),O=v("vh-modal"),E=v("vh-input"),J=v("vh-table"),P=v("vh-select"),q=v("vh-col"),M=v("vh-pagination"),L=v("vh-row"),I=T("can");return f(),k("div",x,[m(O,{show:t.showFormConfirmRemove,title:e.$t("common.manager.title.remove"),onHide:o[2]||(o[2]=n=>i.onHideForm())},{footer:l(({})=>{var n,r,u,b,w,y;return[m(c,{size:"sm",color:"warning",beforeIcon:(u=(r=(n=t.optionConfig)==null?void 0:n.icon)==null?void 0:r.cancel)!=null?u:"",onClick:o[0]||(o[0]=s=>i.onHideForm())},{default:l(()=>{var s,h;return[_(d(e.$t((h=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:h.cancel)),1)]}),_:1},8,["beforeIcon"]),m(c,{size:"sm",color:"danger",beforeIcon:(y=(w=(b=t.optionConfig)==null?void 0:b.icon)==null?void 0:w.remove)!=null?y:"",onClick:o[1]||(o[1]=s=>i.onRemoveData())},{default:l(()=>{var s,h;return[_(d(e.$t((h=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:h.remove)),1)]}),_:1},8,["beforeIcon"])]}),default:l(()=>{var n,r;return[a.showErrors?(f(),z(C,{key:0,errors:t.errors},null,8,["errors"])):U("",!0),S(e.$slots,"content_confirmDelete",{data:t.dataUpdate,errors:t.errors,app:this}),_(" "+d(!e.$slots.content_confirmDelete&&e.$t((r=(n=t.optionConfig)==null?void 0:n.title)==null?void 0:r.confirmDelete))+" ",1)]}),_:3},8,["show","title"]),m(O,{size:t.optionConfig.formsize({isNew:t.isNew,data:t.dataUpdate},this.formsize),title:t.isNew?e.$t("common.manager.title.new"):e.$t("common.manager.title.edit"),show:t.showFormUpdate,onHide:o[5]||(o[5]=n=>i.onHideForm())},{footer:l(({})=>{var n,r,u,b,w,y;return[m(c,{size:"sm",color:"warning",beforeIcon:(u=(r=(n=t.optionConfig)==null?void 0:n.icon)==null?void 0:r.cancel)!=null?u:"",onClick:o[3]||(o[3]=s=>i.onHideForm())},{default:l(()=>{var s,h;return[_(d(e.$t((h=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:h.cancel)),1)]}),_:1},8,["beforeIcon"]),m(c,{size:"sm",beforeIcon:(y=(w=(b=t.optionConfig)==null?void 0:b.icon)==null?void 0:w.update)!=null?y:"",onClick:o[4]||(o[4]=s=>i.onUpdateData())},{default:l(()=>{var s,h;return[_(d(e.$t((h=(s=t.optionConfig)==null?void 0:s.button)==null?void 0:h.update)),1)]}),_:1},8,["beforeIcon"])]}),default:l(()=>[a.showErrors?(f(),z(C,{key:0,errors:t.errors},null,8,["errors"])):U("",!0),S(e.$slots,"form_update",{data:t.dataUpdate,app:this,errors:t.errors,isNew:t.isNew})]),_:3},8,["size","title","show"]),g("div",$,[g("div",ee,[D(m(c,{size:"sm",beforeIcon:(K=(B=(H=t.optionConfig)==null?void 0:H.icon)==null?void 0:B.new)!=null?K:"",onClick:o[6]||(o[6]=n=>i.onShowFormUpdate({},!0))},{default:l(()=>{var n,r;return[_(d(e.$t((r=(n=t.optionConfig)==null?void 0:n.button)==null?void 0:r.new)),1)]}),_:1},8,["beforeIcon"]),[[I,t.optionConfig.can.new]]),S(e.$slots,"header_left",{app:this})]),g("div",oe,[S(e.$slots,"header_center")]),g("div",te,[S(e.$slots,"header_right",{app:this}),m(E,{placeholder:"Search",style:{width:"150px"},onKeypress:i.onInputSearch,onBlur:o[7]||(o[7]=n=>n.target.value=this.search)},null,8,["onKeypress"])])]),g("div",ne,[m(J,{source:t.source,option:i.optionConfigAction,sort:t.sort,filter:t.filter,start:t.row_from,onSort:o[8]||(o[8]=(n,r)=>i.onSort(n,r)),onFilter:o[9]||(o[9]=(n,r)=>i.onFilter(n,r))},{field_button_action:l(({row:n,index:r,start:u})=>{var b,w,y,s,h,R;return[g("span",ie,[S(e.$slots,"action_before",{row:n,app:this,index:r,start:u}),t.optionConfig.checkButtonDelete({row:n,index:r,start:u})?D((f(),z(c,{key:0,size:"sm",color:"danger",onClick:F=>i.onShowConfirmRemove(n),beforeIcon:(y=(w=(b=t.optionConfig)==null?void 0:b.icon)==null?void 0:w.remove)!=null?y:""},{default:l(()=>{var F,N;return[_(d(e.$t((N=(F=t.optionConfig)==null?void 0:F.button)==null?void 0:N.remove)),1)]}),_:2},1032,["onClick","beforeIcon"])),[[I,t.optionConfig.can.remove]]):U("",!0),t.optionConfig.checkButtonUpdate({row:n,index:r,start:u})?D((f(),z(c,{key:1,size:"sm",beforeIcon:(R=(h=(s=t.optionConfig)==null?void 0:s.icon)==null?void 0:h.edit)!=null?R:"",onClick:F=>i.onShowFormUpdate(n)},{default:l(()=>{var F,N;return[_(d(e.$t((N=(F=t.optionConfig)==null?void 0:F.button)==null?void 0:N.edit)),1)]}),_:2},1032,["beforeIcon","onClick"])),[[I,t.optionConfig.can.edit]]):U("",!0),S(e.$slots,"action_after",{row:n,app:this,index:r,start:u})])]}),_:3},8,["source","option","sort","filter","start"])]),g("div",re,[m(L,null,{default:l(()=>[m(q,{class:"col-none",style:{width:"105px",flex:"none"}},{default:l(()=>[m(P,{modelValue:t.size_page,"onUpdate:modelValue":o[10]||(o[10]=n=>t.size_page=n),class:"vh-inline-block",source:t.pages,onChange:o[11]||(o[11]=n=>i.onChangePage(1))},null,8,["modelValue","source"])]),_:1}),m(q,null,{default:l(()=>[this.last_page>0?(f(),z(M,{key:0,current:t.current_page,start:i.page_start,end:i.page_end,last:t.last_page,onPage:o[12]||(o[12]=n=>i.onChangePage(n)),next:">>",previous:"<<"},null,8,["current","start","end","last"])):U("",!0)]),_:1})]),_:1})])])}var he=A(Z,[["render",se]]);export{he as M};
