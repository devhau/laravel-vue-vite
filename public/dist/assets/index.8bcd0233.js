import{_ as P,e as j}from"./main.9147d398.js";import{r as d,u as M,o as y,c as T,b as p,w as a,e as _,t as C,i as F,f as k,k as w,a as S,v as z}from"./vendor.b642d5e9.js";const G={itemKey:"id",formsize:({isNew:e,data:t},l)=>l,checkButtonDelete:({row:e,index:t,start:l})=>!0,checkButtonUpdate:({row:e,index:t,start:l})=>!0,query:{new:({option:e,app:t})=>({}),sort:({option:e,app:t})=>({}),filter:({option:e,app:t})=>({})},can:{index:"",new:"",edit:"",remove:""},empty:"common.manager.table.empty",title:{new:"common.manager.title.new",edit:"common.manager.title.edit",confirmDelete:"common.manager.title.confirmDelete",remove:"common.manager.title.remove",action:"common.manager.title.action"},button:{new:"common.manager.button.new",edit:"common.manager.button.edit",remove:"common.manager.button.remove",delete:"common.manager.button.delete",cancel:"common.manager.button.cancel",active:"common.manager.button.active",view:"common.manager.button.view",detail:"common.manager.button.detail",update:"common.manager.button.update"},icon:{new:"bi bi-plus-square",edit:"bi bi-pencil-square",remove:"bi bi-trash",delete:"bi bi-trash",cancel:"bi bi-x",active:"bi bi-check-square",view:"bi bi-plus-square",detail:"bi bi-plus-square",update:"bi bi-pencil-square"}},L={components:{errors:j},props:{option:{},showAction:{default:!0},showErrors:{default:!0},formsize:{defalut:"sm"}},computed:{page_start(){return this.current_page-3>0?this.current_page-3:1},page_end(){return this.current_page+3<this.last_page?this.current_page+3:this.last_page},optionConfigAction(){if(!this.showAction)return this.optionConfig;let{columns:e}=this.optionConfig,t=this.$t("common.manager.title.action");return e=[...e,{title:t,field:"button_action",isSort:!1,isFilter:!1}],{...this.optionConfig,columns:e}}},data(){return{loading:!1,optionConfig:{},showFormUpdate:!1,showFormConfirmRemove:!1,isNew:!1,dataUpdate:{},errors:void 0,pages:[10,15,25,50,100],source:[],search:"",sort:{},filter:{},current_page:0,size_page:15,from_page:0,last_page:0,per_page:15,row_from:0,row_to:0,total:0}},methods:{onInputSearch(e){e.keyCode==13&&(this.search=e.target.value,this.onSearch())},onSort(e,t){this.sort={},this.sort[e.field]=t,this.$emit("sort",e,t),this.onSearch()},onFilter(e,t){this.filter[e.field]=t,this.$emit("filter",e,t),this.onSearch()},onSearch(){let{api:e}=this.optionConfig;e.getAll({sort:this.sort,filter:this.filter,search:this.search,page:this.current_page,per_page:this.size_page}).then(({data:t})=>{if(t&&t.OK){let{data:l,current_page:m,from:o,to:n,last_page:N,total:c}=t.data;this.source=l,this.current_page=m,this.row_from=o,this.row_to=n,this.last_page=N,this.total=c}})},onChangePage(e){this.current_page=e,this.onSearch()},onRemoveData(){let{api:e,validate:t,itemKey:l}=this.optionConfig;this.errors=void 0,e.remove(this.dataUpdate[l]).then(m=>{m.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=m.data.errors})},onUpdateData(){let{api:e,validate:t,itemKey:l}=this.optionConfig;this.errors=void 0,(!t||t({data:this.dataUpdate,isNew:this.isNew}))&&(this.isNew?e.add(this.dataUpdate).then(m=>{m.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=m.data.errors}):e.edit(this.dataUpdate[l],this.dataUpdate).then(m=>{m.data.OK==!0?(this.onSearch(),this.onHideForm()):this.errors=m.data.errors}))},onShowConfirmRemove(e){this.errors=void 0,this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormConfirmRemove=!0},onShowFormUpdate(e,t=!1){if(this.errors=void 0,this.isNew=t,e){let{api:l,validate:m,itemKey:o}=this.optionConfig;e[o]?(this.dataUpdate=JSON.parse(JSON.stringify({})),this.showFormUpdate=!0,this.loading=!0,l.get(e[o]).then(({data:n})=>{this.dataUpdate=JSON.parse(JSON.stringify(n.data)),this.loading=!1})):(this.dataUpdate=JSON.parse(JSON.stringify(e)),this.showFormUpdate=!0)}else this.dataUpdate=JSON.parse(JSON.stringify({})),this.showFormUpdate=!0},onHideForm(){this.errors=void 0,this.showFormUpdate=!1,this.showFormConfirmRemove=!1},setOptionConfig(e){this.optionConfig=Object.assign(G,e)},clearFilter(){var e,t;this.optionConfig.query.sort&&(this.sort=(e=this.optionConfig.query.sort({option:this.optionConfig,app:this}))!=null?e:{}),this.optionConfig.query.filter&&(this.filter=(t=this.optionConfig.query.filter({option:this.optionConfig,app:this}))!=null?t:{}),this.onSearch()}},created(){this.setOptionConfig(this.option)},mounted(){this.setOptionConfig(this.option),this.clearFilter()},watch:{option:{handler:function(e){this.setOptionConfig(e)},deep:!0,immediate:!0}},setup(){}},Q={class:"vh-manager"},W={class:"vh-manager__header"},X={class:"vh-manager__header--left"},Y={class:"vh-manager__header--center"},Z={class:"vh-manager__header--right"},x={class:"vh-manager__body"},$={class:"vh-manager__body--action"},ee={class:"vh-manager__footer"};function te(e,t,l,m,o,n){var q,H,J;const N=d("errors"),c=d("vh-button"),I=d("vh-modal"),B=d("vh-input"),R=d("vh-table"),V=d("vh-select"),D=d("vh-col"),A=d("vh-pagination"),E=d("vh-row"),O=M("can");return y(),T("div",Q,[p(I,{show:o.showFormConfirmRemove,title:e.$t("common.manager.title.remove"),onHide:t[2]||(t[2]=i=>n.onHideForm())},{footer:a(({})=>{var i,r,f,u,g,v;return[p(c,{size:"sm",color:"warning",beforeIcon:(f=(r=(i=o.optionConfig)==null?void 0:i.icon)==null?void 0:r.cancel)!=null?f:"",onClick:t[0]||(t[0]=s=>n.onHideForm())},{default:a(()=>{var s,h;return[_(C(e.$t((h=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:h.cancel)),1)]}),_:1},8,["beforeIcon"]),p(c,{size:"sm",color:"danger",beforeIcon:(v=(g=(u=o.optionConfig)==null?void 0:u.icon)==null?void 0:g.remove)!=null?v:"",onClick:t[1]||(t[1]=s=>n.onRemoveData())},{default:a(()=>{var s,h;return[_(C(e.$t((h=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:h.remove)),1)]}),_:1},8,["beforeIcon"])]}),default:a(()=>{var i,r;return[l.showErrors?(y(),F(N,{key:0,errors:o.errors},null,8,["errors"])):k("",!0),w(e.$slots,"content_confirmDelete",{data:o.dataUpdate,errors:o.errors,app:this}),_(" "+C(!e.$slots.content_confirmDelete&&e.$t((r=(i=o.optionConfig)==null?void 0:i.title)==null?void 0:r.confirmDelete))+" ",1)]}),_:3},8,["show","title"]),p(I,{size:o.optionConfig.formsize({isNew:o.isNew,data:o.dataUpdate},this.formsize),title:o.isNew?e.$t("common.manager.title.new"):e.$t("common.manager.title.edit"),show:o.showFormUpdate,loading:o.loading,onHide:t[5]||(t[5]=i=>n.onHideForm())},{footer:a(({})=>{var i,r,f,u,g,v;return[p(c,{size:"sm",color:"warning",beforeIcon:(f=(r=(i=o.optionConfig)==null?void 0:i.icon)==null?void 0:r.cancel)!=null?f:"",onClick:t[3]||(t[3]=s=>n.onHideForm())},{default:a(()=>{var s,h;return[_(C(e.$t((h=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:h.cancel)),1)]}),_:1},8,["beforeIcon"]),p(c,{size:"sm",beforeIcon:(v=(g=(u=o.optionConfig)==null?void 0:u.icon)==null?void 0:g.update)!=null?v:"",onClick:t[4]||(t[4]=s=>n.onUpdateData())},{default:a(()=>{var s,h;return[_(C(e.$t((h=(s=o.optionConfig)==null?void 0:s.button)==null?void 0:h.update)),1)]}),_:1},8,["beforeIcon"])]}),default:a(()=>[l.showErrors?(y(),F(N,{key:0,errors:o.errors},null,8,["errors"])):k("",!0),w(e.$slots,"form_update",{data:o.dataUpdate,app:this,errors:o.errors,isNew:o.isNew})]),_:3},8,["size","title","show","loading"]),S("div",W,[S("div",X,[z(p(c,{size:"sm",beforeIcon:(J=(H=(q=o.optionConfig)==null?void 0:q.icon)==null?void 0:H.new)!=null?J:"",onClick:t[6]||(t[6]=i=>n.onShowFormUpdate({},!0))},{default:a(()=>{var i,r;return[_(C(e.$t((r=(i=o.optionConfig)==null?void 0:i.button)==null?void 0:r.new)),1)]}),_:1},8,["beforeIcon"]),[[O,o.optionConfig.can.new]]),w(e.$slots,"header_left",{app:this})]),S("div",Y,[w(e.$slots,"header_center")]),S("div",Z,[w(e.$slots,"header_right",{app:this}),p(B,{placeholder:"Search",style:{width:"150px"},onKeypress:n.onInputSearch,onBlur:t[7]||(t[7]=i=>i.target.value=this.search)},null,8,["onKeypress"])])]),S("div",x,[p(R,{source:o.source,option:n.optionConfigAction,sort:o.sort,filter:o.filter,start:o.row_from,onSort:t[8]||(t[8]=(i,r)=>n.onSort(i,r)),onFilter:t[9]||(t[9]=(i,r)=>n.onFilter(i,r))},{field_button_action:a(({row:i,index:r,start:f})=>{var u,g,v,s,h,K;return[S("span",$,[w(e.$slots,"action_before",{row:i,app:this,index:r,start:f}),o.optionConfig.checkButtonDelete({row:i,index:r,start:f})?z((y(),F(c,{key:0,size:"sm",color:"danger",onClick:b=>n.onShowConfirmRemove(i),beforeIcon:(v=(g=(u=o.optionConfig)==null?void 0:u.icon)==null?void 0:g.remove)!=null?v:""},{default:a(()=>{var b,U;return[_(C(e.$t((U=(b=o.optionConfig)==null?void 0:b.button)==null?void 0:U.remove)),1)]}),_:2},1032,["onClick","beforeIcon"])),[[O,o.optionConfig.can.remove]]):k("",!0),o.optionConfig.checkButtonUpdate({row:i,index:r,start:f})?z((y(),F(c,{key:1,size:"sm",beforeIcon:(K=(h=(s=o.optionConfig)==null?void 0:s.icon)==null?void 0:h.edit)!=null?K:"",onClick:b=>n.onShowFormUpdate(i)},{default:a(()=>{var b,U;return[_(C(e.$t((U=(b=o.optionConfig)==null?void 0:b.button)==null?void 0:U.edit)),1)]}),_:2},1032,["beforeIcon","onClick"])),[[O,o.optionConfig.can.edit]]):k("",!0),w(e.$slots,"action_after",{row:i,app:this,index:r,start:f})])]}),_:3},8,["source","option","sort","filter","start"])]),S("div",ee,[p(E,null,{default:a(()=>[p(D,{class:"col-none",style:{width:"105px",flex:"none"}},{default:a(()=>[p(V,{modelValue:o.size_page,"onUpdate:modelValue":t[10]||(t[10]=i=>o.size_page=i),class:"vh-inline-block",source:o.pages,onChange:t[11]||(t[11]=i=>n.onChangePage(1))},null,8,["modelValue","source"])]),_:1}),p(D,null,{default:a(()=>[this.last_page>0?(y(),F(A,{key:0,current:o.current_page,start:n.page_start,end:n.page_end,last:o.last_page,onPage:t[12]||(t[12]=i=>n.onChangePage(i)),next:">>",previous:"<<"},null,8,["current","start","end","last"])):k("",!0)]),_:1})]),_:1})])])}var ne=P(L,[["render",te]]);export{ne as M};
